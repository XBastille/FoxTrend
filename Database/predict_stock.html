<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src='https://cdn.plot.ly/plotly-2.32.0.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"></script>
    <link rel="stylesheet" href="predict_stock.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Protest+Guerrilla&display=swap" rel="stylesheet">
</head>

<body>    
      
    <ul class="icons open"> 
        <a href="#" class="fox-icon-link">
            <img src="media/fox.jpg" alt="Fox Icon" class="logo">
          </a>
        <li class="Icon-items" data-name="Home">
            <img src="media/home.jpg" id="item1"> 
            <span class="icon-name">Home</span>
        </li>
        <li class="Icon-items" data-name="Watch">
            <img src="media/recent_watch.jpg" id="item2"> 
            <span class="icon-name">Watch</span>
        </li>
        <li class="Icon-items" data-name="Lists">
            <img src="media/list.jpg" id="item3">
            <span class="icon-name">Lists</span>
        </li>
        <li class="Icon-items" data-name="Donate">
            <img src="media/donate.jpg" id="item4">
            <span class="icon-name">Donate</span>
        </li>
        <li class="Icon-items" data-name="Profile">
            <img src="media/account.jpg" id="item5">
            <span class="icon-name">Profile</span>
        </li>
        <li class="Arrow">
            <img src="media/arrow-right.jpg">
        </li>
    </ul>     
            <div class="search-container">
                <input type="text" class="search-bar" placeholder="Search">
                <i class="search-icon fas fa-search"></i>
                <div class="magnifying-glass">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </div>
                <div class="navigationBar">
                    <a href="#" class="serv">
                        Services
                        <svg width="20" height="20" viewBox="0 -4 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </a>
                    <a href="#" class="comp">
                        Company
                        <svg width="20" height="20" viewBox="0 -4 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </a>
                    <a href="#" class="blog">Blog</a>  
                    <a href="#" class="port">Contact Us</a>
                    <div class="services-dropdown">
                        <div class="services-dropdown-content">
                            <div class="services-label">
                                <h1>Services</h1>
                            </div>
                            <div class="services-dropdown-column">
                                <div class="primary-section">
                                <h2>Primary <span class="arrow">→</span></h2>
                                <div class="primary-elements">
                                    <a href="#">Stock Market Prediction</a>
                                </div>
                            </div>
                            </div>
                            <div class="services-dropdown-column">
                                <h3>Secondary <span class="arrow">→</span></h3>
                                <div class="secondary-section">
                                <div class="secondary-elements">
                                    <a href="#">Used Car Prediction</a>
                                    <a href="#">Housing Prediction</a>
                                    <a href="#">Loan Approval Prediction</a>
                                </div>
                            </div>
                            </div>
                            <img src="media/services.jpg" alt="Your Alt Text" class="service-image">
                        </div>
                    </div>
                        <div class="company-dropdown">
                        <div class="company-dropdown-content">
                            <div class="company-label">
                                <h1>Company</h1>
                            </div>
                            <div class="company-dropdown-column">
                                <h2>MORE ABOUT US</h2>
                                <a href="#">About Us</a>
                                <a href="#">Blog</a>
                                <a href="#">Privacy Policy</a>
                                <a href="#">License</a>
                            </div>
                            <div class="company-dropdown-column">
                                <h2>SOCIAL</h2>
                                <a href="#">LinkedIn</a>
                                <a href="#">Instagram</a>
                                <a href="#">X</a>
                            </div>
                            <div class="company-dropdown-column">
                                <h2>CONTACTS</h2>
                                <a href="#">Book a Call</a>
                                <a href="#">Mail Us</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

          <style>
            ul {
              list-style-type: none;
              padding-inline-start: 0;
            }
          </style>

<div class="prediction-title-container">
    <h1 class="prediction-title">Prediction</h1>
</div>

<div id="myplot" style="width:1100px; height:400px; margin-left: 160px; margin-bottom: 0px;"></div>  
<div class="table-container">
    <a href="#" id="download-data" class="download-btn">Download Data</a>
    <table id="prediction-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Close</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

    <footer>
        <div class="footer-links">
        
    
                
             <img src="media/website_logo.jpg" class="foot-logo">
                    
        

                <div class="footer-block">
                <div class="footer-title" id="Comp">Company</div>
                   <li><a class="links" id="mail">Mail us</a></li>
                    <li><a class="links" id="SERV">Services</a></li>
                </div>

                <div class="footer-block">
                <div class="footer-title" id="more">More</div>
                    <li><a class="links" id="tandc">Blog</a></li>
                    <li><a class="links" id="career">License</a></li>
                    <li><a class="links" id="privacy">Privacy Policy</a></li>
                </div>
            
                <div class="footer-block">
                <div class="footer-title" id="social">Social</div>
                <li><a class="links" id="linkedin">LinkedIn</a></li>
                <li> <a  class="links" id="yt">Instagram</a></li>
                <li> <a  class="links" id="tw">X</a></li>
                </div>
            
        </div>
    </footer> 




    <script>
        Papa.parse("stock_data_1.csv", {
    download: true,
    header: true,
    complete: function(results) {
        const xarray = [];
        const yarray = [];
        
        results.data.forEach(row => {
            xarray.push(row['Date']);
            yarray.push(parseFloat(row['Close']));
        });
        
        const data = [{
            x: xarray,
            y: [],
            mode: "lines",
            type: "scatter",
            fill: "tozeroy",
            fillgradient: {
                type: 'vertical',
                colorscale: [[0,'rgba(0,0,0,0)'], [1,'rgba(96,0,147,1)']],
            },
            line: {
                width: 2
            }
        }];

        const layout = {
            xaxis: {
                range: [xarray[0], xarray[xarray.length-1]],
                title: {
                    text: "Date",
                    font: {
                        color: "white"
                    }
                },
                tickfont: {
                    color: "white"
                }
            },
            yaxis: {
                range: [0, Math.max(...yarray)+20],
                title: {
                    text: "Prices",
                    font: {
                        color: "white"
                    }
                },
                tickfont: {
                    color: "white"
                }
            },
            colorway: ['#7834a8'],
            plot_bgcolor: "black",
            paper_bgcolor: "black",
        };
        
        Plotly.newPlot("myplot", data, layout);

        const tbody = document.querySelector('#prediction-table tbody');
        results.data.forEach(row => {
            if (row.Date && row.Close) {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.Date}</td>
                    <td>$${parseFloat(row.Close).toFixed(2)}</td>
                `;
                tbody.appendChild(tr);
            }
        });

        let i = 0;
        let id;
        function animate() {
            if (i < xarray.length) {
                Plotly.extendTraces("myplot", {
                    x: [[xarray[i]]],
                    y: [[yarray[i]]]
                }, [0]);
                i++;
                id = requestAnimationFrame(animate);
            }
        }
        animate();

        const stp = document.getElementById('stp');
        stp.addEventListener('click', () => {
            Plotly.react("myplot", [{
                x: xarray,
                y: yarray,
                mode: "lines",
                type: "scatter",
                fill: "tozeroy",
                fillgradient: {
                    type: 'vertical',
                    colorscale: [[0,'rgba(0,0,0,0)'], [1,'rgba(96,0,147,1)']],
                },
                line: {
                    width: 2
                }
            }], layout);
            cancelAnimationFrame(id);
        });

        document.getElementById('download-data').addEventListener('click', function(e) {
            e.preventDefault();
            let csv = 'Date,Close\n';
            results.data.forEach(row => {
                if (row.Date && row.Close) {
                    csv += `${row.Date},${row.Close}\n`;
                }
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'stock_prediction_data.csv';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        });
    }
});

    </script>

    <script src="predict_stock.js"></script>
</body>
</html>